---
description: 定義文字格式 (文字檔驅動程式)
title: 定義文字格式 (文字檔驅動程式) |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: fe992d4ea7cf81387bc56ef9c384404b015b52a9
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "88340944"
---
# <a name="defining-text-format-text-file-driver"></a>定義文字格式 (文字檔驅動程式)
使用文字驅動程式時，您可以使用 [ **定義文字格式** ] 對話方塊來定義所選檔案中的資料行格式。 這個對話方塊可讓您指定每個資料表的架構。 這項資訊會寫入資料來源目錄中的 Schema.ini 檔案。 針對每個文字資料來源目錄建立個別的 Schema.ini 檔案。  
  
> [!NOTE]  
>  相同的預設檔案格式會套用至所有新的文字資料表。 CREATE TABLE 語句所建立的所有檔案都會繼承這些相同的預設格式值，這是藉由在 [資料表] 清單中選擇的 [**定義文字格式**] 對話方塊中選取檔案格式值所設定 \<default> **Tables** 。 文字驅動程式不會變更現有文字檔的格式，以符合此對話方塊中所定義的格式，但會在使用格式時傳回錯誤，例如當它嘗試從文字檔取出資料時。  
  
 您可以在 [ **定義文字格式** ] 對話方塊中使用下列選項：  
  
|選項|資訊|  
|------------|-----------------|  
|**加入**|使用 [ **資料類型**]、[ **名稱**] 和 [ **寬度** ] 中的值，從對話方塊加入資料行（如果適用的話），以及 Schema.ini 的日期分隔符號值。|  
|**字元**|**ANSI** 或 **OEM**。 OEM 指定非 ANSI 字元集。 如果此對話方塊先前未定義 [ **資料表]** 清單中所選取專案的格式，則預設為 OEM。|  
|**資料行名稱標頭**|指出所選資料表第一個資料列的資料行是否要當做資料行名稱使用。 是 **TRUE** 或 **FALSE**。 如果在 **資料表** 清單中選取的專案格式先前未由此對話方塊定義，則預設為 FALSE。|  
|**資料行**|列出所選資料表中每個資料行的資料行名稱。 資料行的順序會反映資料表中資料行的順序。 如果已在 [ **資料表]** 清單中選取檔案，則會啟用此清單。|  
|**資料類型**|可以是 BIT、BYTE、CHAR、CURRENCY、DATE、FLOAT、INTEGER、LONGCHAR、SHORT 或 SINGLE。 日期資料類型的格式可以是下列格式： "dd-yy"、"mm-yy"、"mmm-yy"、"yyyy-mm-dd" 或 "yyyy mmm dd"。 "mm" 代表月份的數位;"mmm" 代表月份的字母。|  
|**分隔符號**|指定要用來分隔資料行的自訂分隔符號。 選取 **自訂分隔** 格式時啟用。 分隔符號的長度只能是一個字元，而雙引號 ( ") 不能用來做為分隔符號。  (不能以十六進位或十進位格式指定分隔符號。 ) |  
|**格式**|分隔或固定長度。 如果有分隔，則表示使用的分隔符號類型：逗號 (CSV) 、tab 或特殊字元 (自訂) 。 如果此對話方塊先前未定義 [**資料表]** 清單中所選取專案的格式，則此值預設為**CSV 分隔**。<br /><br /> 如果 **格式** 為固定長度且 **資料行名稱標頭** 為 TRUE，則第一行必須以逗號分隔。|  
|**想**|會根據 **格式** 方塊選取專案掃描資料表的內容，自動產生所選資料表中資料行的資料類型、名稱和寬度值。 當資料表格式為分隔時啟用。 所有先前定義的資料行 **清單中的資料** 行都會清除，並以新的專案取代。 如果未選取 [ **資料行名稱標頭** ]，資料行名稱會自動產生為 "F1"、"F2" 等等。 [ **資料類型** ] 方塊中不會顯示任何預設值。<br /><br /> 此功能只適用于小於64513個位元組的資料行。|  
|**Modify**|使用 **資料類型**、 **名稱**和 **寬度**中的值修改選取的資料行。|  
|**名稱**|顯示所選取資料行的名稱。 可以用來指定現有資料行或新資料行的新資料行名稱。<br /><br /> 如果 **資料行名稱標頭** 為 TRUE，則會忽略所顯示的資料行名稱。|  
|**移除**|刪除選取的資料行。|  
|**要掃描的資料列**|根據現有資料設定資料行和資料行資料類型時，安裝程式或驅動程式將掃描的資料列數目。<br /><br /> 您可以輸入從1到32767的數位，以掃描的資料列數目。 如果此對話方塊先前未定義 [ **資料表]** 清單中所選取專案的格式，此值會預設為25。  (超出限制的數位將會傳回錯誤。 ) |  
|**資料表**|包含在 [ **文字設定** ] 對話方塊中所選取的目錄中，符合指定的延伸模組清單之所有檔案的清單。<br /><br /> 當 \<default> 選取 []，且下列其中一項為 true 時，[ **資料表]** 群組中的 [資料表屬性] 的值會寫入 Schema.ini (Schema.ini 中沒有其他專案會被觸及) ：<br /><br /> -指定的目錄中沒有 Schema.ini。<br />-Schema.ini 檔案存在，但在目錄中有指定副檔名)  (的其中一個文字檔 Schema.ini 沒有區段。<br />-文字檔的區段存在於 Schema.ini 中，但是主體是空的。<br /><br /> \<default>選取時，會停用資料**行**群組。|  
|**寬度**|您可以針對 CHAR 或 LONGCHAR 資料行變更資料行的寬度。 如果此對話方塊先前未定義 [ **資料表]** 清單中所選取專案的格式，則寬度預設為1。<br /><br /> 若為其他資料類型，則會停用寬度控制項，且不會顯示任何值。|
