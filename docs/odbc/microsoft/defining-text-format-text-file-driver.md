---
title: 定義文字格式（文字檔驅動程式） |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/27/2020
ms.locfileid: "81307659"
---
# <a name="defining-text-format-text-file-driver"></a>定義文字格式 (文字檔驅動程式)
使用文字驅動程式時，您可以使用 [**定義文字格式**] 對話方塊來定義所選檔案中的資料行格式。 這個對話方塊可讓您指定每個資料表的架構。 這項資訊會寫入至資料來源目錄中的架構 .ini 檔案。 針對每個文字資料來源目錄，會建立個別的架構 .ini 檔案。  
  
> [!NOTE]  
>  相同的預設檔案格式會套用到所有新的文字資料表。 CREATE TABLE 語句所建立的所有檔案都會繼承那些相同的預設格式值，其設定方式是在 [**定義文字格式**] 對話方塊中，選取\<[**資料表**] 清單中所選擇的預設> 的 [檔案格式值]。 文字驅動程式不會變更現有文字檔的格式，以符合此對話方塊中所定義的格式，但會在使用格式時傳回錯誤，例如當它嘗試從文字檔取出資料時。  
  
 [**定義文字格式**] 對話方塊有下列選項：  
  
|選項|資訊|  
|------------|-----------------|  
|**加入**|使用 [**資料類型**]、[**名稱**] 和 [**寬度**] 中的值，從 [] 對話方塊中加入資料行，如果適用的話，則從 schema.ini 的日期分隔值。|  
|**長度**|**ANSI**或**OEM**。 OEM 指定非 ANSI 字元集。 如果這個對話方塊先前尚未定義 [**資料表]** 清單中所選取專案的格式，這會預設為 OEM。|  
|**資料行名稱標頭**|指出所選資料表第一個資料列的資料行是否要當做資料行名稱使用。 **TRUE**或**FALSE**。 如果這個對話方塊先前尚未定義 [**資料表]** 清單中所選取專案的格式，則預設為 FALSE。|  
|**資料行**|列出所選資料表中每個資料行的資料行名稱。 資料行的順序會反映資料表中資料行的順序。 如果已在 [**資料表]** 清單中選取檔案，就會啟用此清單。|  
|**資料類型**|可以是 BIT、BYTE、CHAR、CURRENCY、DATE、FLOAT、INTEGER、LONGCHAR、SHORT 或 SINGLE。 日期資料類型可以採用下列格式：「dd-mmm-yy」、「mm-dd-yy」、「yyyy-mm-dd」、「yyyy-mm dd」或「yyyy mmm-dd」。 "mm" 代表月份數;"mmm" 代表月份的字母。|  
|**分隔符號**|指定要用來分隔資料行的自訂分隔符號。 已在選取**自訂分隔**格式時啟用。 分隔符號的長度只能是一個字元，而且不能使用雙引號（"）做為分隔符號。 （不得以十六進位或十進位格式指定分隔符號）。|  
|**[格式]**|分隔或固定長度。 如果是分隔的，則表示所使用的分隔符號類型：逗號（CSV）、索引標籤或特殊字元（自訂）。 如果這個對話方塊先前尚未定義 [**資料表]** 清單中所選取專案的格式，則預設為 [ **CSV 分隔**]。<br /><br /> 如果**Format**為固定長度，且**資料行名稱標頭**為 TRUE，則第一行必須以逗號分隔。|  
|**知道**|會根據選取的**格式**方塊，來掃描資料表的內容，以自動產生所選資料表中資料行的資料類型、名稱和寬度值。 當資料表格式分隔時啟用。 [資料**行**] 清單中先前定義的任何資料行都會被清除，並以新的專案取代。 如果未選取 [**資料行名稱] 標頭**，則會自動產生資料行名稱，例如 "F1"、"F2" 等等。 [**資料類型**] 方塊中不會顯示任何預設值。<br /><br /> 這種功能只適用于小於64513個位元組的資料行。|  
|**修改**|使用 [**資料類型**]、[**名稱**] 和 [**寬度**] 中的值，修改選取的資料行。|  
|**名稱**|顯示所選取資料行的名稱。 可以用來為現有的資料行或新資料行指定新的資料行名稱。<br /><br /> 如果**資料行名稱標頭**為 TRUE，則會忽略所顯示的資料行名稱。|  
|**移除**|刪除選取的資料行。|  
|**要掃描的資料列**|安裝程式或驅動程式會在根據現有資料來設定資料行和資料行資料類型時，將掃描的資料列數目。<br /><br /> 針對要掃描的資料列數目，您可以輸入1到32767之間的數位。 如果這個對話方塊先前尚未定義 [**資料表]** 清單中所選取專案的格式，這會預設為25。 （超出限制的數位將會傳回錯誤）。|  
|**資料表**|包含在 [**文字設定**] 對話方塊中選取的目錄中，符合指定之副檔名清單的所有檔案清單。<br /><br /> 選取\<[預設>] 且下列其中一項為 true 時，[**資料表]** 群組中的 [資料表] 屬性值會寫入至 [schema.ini] （不會觸及架構中的其他專案）：<br /><br /> -指定的目錄中沒有任何 schema.ini。<br />-架構 .ini 檔案已經存在，但在目錄中沒有任何一個文字檔（具有指定副檔名）的 web.config 中沒有區段。<br />-文字檔的區段存在於 schema.ini 中，但主體是空的。<br /><br /> 選取\<[預設>] 時，會停用 [資料**行**] 群組。|  
|**寬度**|可以針對 CHAR 或 LONGCHAR 資料行變更資料行的寬度。 如果這個對話方塊先前尚未定義 [**資料表]** 清單中所選取專案的格式，則寬度預設為1。<br /><br /> 若為其他資料類型，則會停用寬度控制項，而且不會顯示任何值。|
