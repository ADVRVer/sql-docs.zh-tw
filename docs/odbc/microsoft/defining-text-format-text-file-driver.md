---
title: 定義文字格式 (文字檔案驅動程式) |微軟文件
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307659"
---
# <a name="defining-text-format-text-file-driver"></a>定義文字格式 (文字檔驅動程式)
使用文字驅動程式時,可以使用 **「定義文字格式」** 對話方塊來定義選取的檔案中列的格式。 此對話框使您能夠為每個數據表指定架構。 此資訊寫入資料來源目錄中的架構.ini 檔案。 為每個文字資料來源建立單獨的架構.ini 檔。  
  
> [!NOTE]  
>  相同的預設檔案格式適用於所有新的文本資料表。 CREATE TABLE 敘述建立的所有檔案都繼承相同的預設格式值,這些值是透過在 **'定義文字格式'** 對話方塊選擇檔案\<格式值以及「**表**格」 清單中選擇預設> 來設定的。 Text 驅動程式不會更改現有文本檔的格式以匹配此對話框中定義的格式,但在使用該格式時(如嘗試從文本檔案檢索資料時)將返回錯誤。  
  
 以下選項在 **「定義文字格式」** 對話框中可用:  
  
|選項|資訊|  
|------------|-----------------|  
|**加入**|使用對話框中的 **「資料類型**」、「**名稱**」 與「**寬度」** 的值新增欄,如果適用,則從 Schema.ini 添加日期分隔符值。|  
|**字元**|**ANSI**或**OEM**。 OEM 指定非 ANSI 字元集。 如果 **「表」** 清單中選擇的項的格式以前未由此對話方塊定義,則預設為 OEM。|  
|**欄名稱標題**|指示所選表的第一行的列是否用作列名稱。 TRUE**TRUE**或**FALSE**。 如果 **「表」** 清單中選擇的項目的格式以前未由此對話方塊定義,則預設為 FALSE。|  
|**資料行**|列出所選表中每列的欄名稱。 列的順序反映表中列的順序。 如果在 **「表」** 清單中選擇了檔案,則啟用此清單。|  
|**資料類型**|可以是 BIT、位元組、CHAR、貨幣、日期、浮點、整數、長字元、短項或單。 日期數據類型可以採用以下格式:「dd-mmm-yy」、"mm-d-yy"、"mm-d-yy"、"yyyy-mm-dd"或"yyyy-mmm-dd"。 "mm"表示月的數位;"mm"表示數月的字母。|  
|**分隔符號**|指定用於分隔列的自訂分隔符字元。 選擇**自訂分隔**格式時啟用。 分隔符的長度只能是一個字元,雙引號(")不能用作分隔符字元。 (不能以十六進位或十進位格式指定分隔符。|  
|**格式**|分隔長度或固定長度。 如果分隔,指示使用的分隔符類型:逗號 (CSV)、選項卡或特殊字元(自定義)。 如果 **「表格」** 清單中選擇的項目的格式以前沒有由此對話框定義,則此預設值為**CSV 分隔**。<br /><br /> 如果**格式**是固定長度的,並且**列名稱標題**為 TRUE,則第一行必須表示逗號分隔。|  
|**想**|根據 **「格式」** 框選擇掃描表的內容,自動生成所選表中列的資料類型、名稱和寬度值。 在表格式被分隔時啟用。 **欄清單**中以前定義的任何列都將被清除並替換為新條目。 如果未選擇**列名稱標題**,則列名稱將自動生成為"F1"、"F2"等。 **"資料類型'** 框中不顯示預設值。<br /><br /> 此功能僅適用於小於 64,513 位元組的列。|  
|**修改**|使用 **「資料類型**」、「**名稱**」 與「**寬度**」 的值修改所選取的欄位。|  
|**名稱**|顯示所選取資料行的名稱。 可用於為現有列或新列指定新列名稱。<br /><br /> 如果**列名稱標題**為 TRUE,則忽略顯示的欄名稱。|  
|**移除**|刪除選取的欄位。|  
|**要掃描的列**|設置或驅動程式在基於現有資料設置列和列數據類型時將掃描的行數。<br /><br /> 您可以輸入一個數位從 1 到 32767 用於要掃描的行數。 如果 **「表」** 清單中選擇的項的格式以前未由此對話方塊定義,則預設為 25。 (超出限制的數位將返回錯誤。|  
|**資料表**|包含文字**設定對話**框中選擇的目錄中所有檔案的清單,這些檔與指定的副檔名清單匹配。<br /><br /> 選擇\<預設>,並且其中一個為 true 時,**表**組中表屬性的值將寫入 Schema.ini(未觸及 Schema.ini 中的其他項目):<br /><br /> - 指定目錄中沒有架構.<br />- Schema.ini 檔存在,但在 Schema.ini 中不存在目錄中文字檔之一(具有指定擴展名)的節。<br />- 文字檔的部分存在於 Schema.ini 中,但正文為空。<br /><br /> 選擇\<預設>時,將禁用 **"列"** 群組。|  
|**寬度**|可以為 CHAR 或 LONGCHAR 列更改列的寬度。 如果 **「表」** 清單中選擇的項的格式以前未由此對話方塊定義,則寬度預設為 1。<br /><br /> 對於其他數據類型,將禁用寬度控件,並且不顯示任何值。|
