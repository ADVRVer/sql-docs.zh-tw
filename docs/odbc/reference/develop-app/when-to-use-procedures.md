---
title: 何時使用過程 |微軟文件
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 31aeea226bc8c8aa41f748d1d9a97d55147c4d67
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81289095"
---
# <a name="when-to-use-procedures"></a>程序的使用時機
使用過程有很多優點,所有這些都基於使用過程將 SQL 語句從應用程式移動到數據源這一事實。 應用程式中剩下的是可互操作的過程調用。 這些優勢包括:  
  
-   **效能**過程通常是執行 SQL 語句的最快方法。 與準備執行一樣,語句分兩步編譯和執行。 與準備執行不同,過程僅在運行時執行。 它們在不同的時間編譯。  
  
-   **商務規則***業務規則*是關於公司開展業務方式的規則。 例如,可能只允許具有「銷售人員」標題的人員添加新的銷售訂單。 將這些規則放在程式中允許單個公司通過重寫應用程式調用的過程來自定義垂直應用程式,而無需修改應用程式代碼。 例如,訂單輸入應用程式可能會調用具有固定數量的參數的過程**InsertOrder;****InsertOrder**的實現方式可能因公司而異。  
  
-   **可更換性**與將業務規則放在程式中密切相關,即無需重新編譯應用程式即可替換過程。 如果業務規則在公司購買並安裝應用程式後發生更改,則公司可以更改包含該規則的過程。 從應用程式的角度來看,沒有任何變化;它仍然調用特定過程來完成特定任務。  
  
-   **特定於 DBMS 的 SQL**過程為應用程式提供了一種利用特定於 DBMS 的 SQL 的方法,並且仍保持可互通。 例如,在 DBMS 上支援 SQL 中的流控制敘述的過程可能會捕獲並從錯誤中恢復,而不支援流控制語句的 DBMS 上的過程可能只是返回錯誤。  
  
-   **程式在交易中存活**在某些數據源上,當提交或回滾事務時,連接上所有準備好的語句的訪問計劃將被刪除。 通過將 SQL 語句放在永久存儲在數據源中的程式中,這些語句在事務中存活下來。 過程是處於準備、部分準備或未準備狀態的,都是特定於 DBMS 的。  
  
-   **單獨開發**過程可以獨立於應用程式的其餘部分開發。 在大公司中,這可能為進一步利用高度專業化的程式師的技能提供一種方法。 換句話說,應用程式程式師可以編寫使用者介面代碼,資料庫程式師可以編寫過程。  
  
 垂直和自定義應用程式通常使用過程。 這些應用程式傾向於執行固定任務,並且可以在其中硬編碼過程調用。 例如,訂單輸入應用程式可能會調用 **「插入訂單**」、「**刪除訂單**」、「**更新訂單」** 和「**獲取訂單**」的過程。  
  
 從通用應用程式調用過程幾乎沒有理由。 過程通常編寫用於在特定應用程式的上下文中執行任務,因此對泛型應用程式沒有用。 例如,電子表格沒有理由調用剛才提到的**InsertOrder**過程。 此外,泛型應用程式不應在運行時構造過程,希望提供更快的語句執行;這不僅可能比準備或直接執行慢,還需要特定於 DBMS 的 SQL 語句。  
  
 應用程式的一個例外是應用程式開發環境,它通常為程式師提供一種構建 SQL 語句的方法,這些語句執行過程,並可能為程式師提供一種測試過程的方法。 此類環境調用**SQLProcess**列出可用過程和**SQLProcess 列**,以列出過程創建的任何結果集的輸入、輸入/輸出和輸出參數、過程返回值以及列。 但是,必須事先在每個數據源上制定此類程式;這樣做需要特定於 DBMS 的 SQL 語句。  
  
 使用過程有三個主要缺點。 第一,必須為應用程式要使用的每個 DBMS 編寫和編譯過程。 雖然這不是自定義應用程式的問題,但它可以顯著增加垂直應用程式的開發和維護時間,這些應用旨在使用多個 DBMS 運行。  
  
 第二個缺點是許多 DBMS 不支持過程。 同樣,對於設計為使用許多 DBMS 運行的垂直應用程序來說,這很可能是一個問題。 要確定是否支援過程,應用程式使用SQL_PROCEDURES選項呼叫**SQLGetInfo。**  
  
 第三個缺點是 ODBC 沒有定義用於創建過程的標準語法,這尤其適用於應用程式開發環境。 也就是說,儘管應用程式可以互操作調用過程,但它們不能以互操作性創建它們。
