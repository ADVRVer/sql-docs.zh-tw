---
title: 交易隔離等級 (ODBC) |微軟文件
ms.custom: seo-dt-2019
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- dirty reads [ODBC]
- isolation levels [ODBC]
- nonrepeatable reads [ODBC]
- read uncommitted [ODBC]
- read committed [ODBC]
- serializable reads [ODBC]
- phantoms [ODBC]
- transaction isolation [ODBC]
- repeatable reads [ODBC]
- transactions [ODBC], isolation
ms.assetid: 0d638d55-ffd0-48fb-834b-406f466214d4
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 622b4cd7f0db259b5ecfd5be63b27df64be965e7
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81298031"
---
# <a name="transaction-isolation-levels-odbc"></a>交易隔離等級 (ODBC)
*事務隔離級別*是事務隔離成功程度的度量。 特別是,事務隔離級別由是否存在以下現象定義:  
  
-   **髒讀**當事務讀取尚未提交的資料時,將發生*髒讀*。 例如,假設事務 1 更新一行。 事務 2 在事務 1 提交更新之前讀取更新的行。 如果事務 1 回滾更改,事務 2 將具有被視為從未存在的數據。  
  
-   **無法重複讀取**當事務讀取同一行兩次,但每次都獲取不同的資料時,將發生*不可重複的讀取*。 例如,假設事務 1 讀取一行。 事務2 更新或刪除該行並提交更新或刪除。 如果事務 1 重讀該行,它將檢索不同的行值或發現該行已被刪除。  
  
-   **幻影***幻像*是符合搜索條件但最初看不到的行。 例如,假設事務 1 讀取一組滿足某些搜索條件的行。 事務2生成與事務 1 的搜索條件匹配的新行(通過更新或插入)。 如果事務 1 重新執行讀取行的語句,它將獲得一組不同的行。  
  
 四個事務隔離等級(由 SQL-92 定義)是根據這些現象定義的。 在下表中,"X"標記可能發生的每個現象。  
  
|交易隔離等級|髒讀|無法重複讀取|幽靈|  
|---------------------------------|-----------------|-------------------------|--------------|  
|讀取未認可|X|X|X|  
|讀取認可|--|X|X|  
|可重複讀取|--|--|X|  
|可序列化|--|--|--|  
  
 下表描述了 DBMS 實現事務隔離級別的簡單方法。  
  
> [!IMPORTANT]  
>  大多數 DBMS 使用比這些更複雜的方案來增加併發性。 這些示例僅用於說明目的。 特別是,ODBC 沒有規定特定的 DBMS 如何將事務彼此隔離。  
  
|交易隔離|可能實現|  
|---------------------------|-----------------------------|  
|讀取未認可|事務不會彼此隔離。 如果 DBMS 支援其他事務隔離等級,它將忽略它用於實現這些級別的任何機制。 因此,它們不會對其他事務產生負面影響,在讀取未提交級別運行的事務通常是唯讀的。|  
|讀取認可|事務等待其他事務寫入鎖定的行解鎖;這樣可以防止它讀取任何"臟"數據。<br /><br /> 事務在當前行上持有讀取鎖(如果唯讀取行)或寫入鎖(如果更新或刪除該行),以防止其他事務更新或刪除該行。 事務釋放讀取鎖時,它移動離開當前行。 它保留寫入鎖,直到它被提交或回滾。|  
|可重複讀取|事務等待其他事務寫入鎖定的行解鎖;這樣可以防止它讀取任何"臟"數據。<br /><br /> 事務保留返回到應用程式的所有行的讀取鎖,並在它插入、更新或刪除的所有行上寫入鎖。 例如,如果事務包含 SQL 語句 **「從\*訂單中選擇**」,則事務在應用程式獲取行時讀取鎖定行。 如果事務包含 SQL 語句 **「從訂單中刪除」狀態 = 「關閉」,** 則事務在刪除行時將寫入行。<br /><br /> 由於其他事務無法更新或刪除這些行,因此當前事務會避免任何不可重複的讀取。 事務在提交或回滾時釋放其鎖。|  
|可序列化|事務等待其他事務寫入鎖定的行解鎖;這樣可以防止它讀取任何"臟"數據。<br /><br /> 事務在它所影響的行範圍內持有讀取鎖(如果唯讀取行)或寫入鎖(如果它可以更新或刪除行)。 例如,如果事務包含 SQL 語句「從訂單中選擇」,則範圍是整個訂單表;如果事務包含 SQL 語句 **「從訂單中\*選擇 」,** 則範圍為整個訂單表。事務讀取鎖定表,不允許將任何新行插入其中。 如果事務包括 SQL 語句 **「從訂單中刪除」狀態 = 「關閉」,** 則範圍是所有狀態為「關閉」的行;事務寫入鎖定狀態為"關閉"的"訂單"表中的所有行,並且不允許插入或更新任何行,以便生成的行的狀態為"關閉"。<br /><br /> 由於其他事務無法更新或刪除範圍內的行,因此當前事務會避免任何不可重複的讀取。 由於其他事務無法在範圍內插入任何行,因此當前事務可避免任何幻象。 事務在提交或回滾時釋放其鎖。|  
  
 請務必注意,事務隔離級別不會影響事務查看自身更改的能力;因此,事務隔離級別不會影響事務本身的更改。事務始終可以看到它們所做的任何更改。 例如,事務可能由兩個**UPDATE**語句組成,第一個語句將所有員工的工資提高 10%,第二個語句將任何員工的工資設定為該金額的某個最高金額。 這僅作為單個事務成功,因為第二個 UPDATE 語句可以看到第一個**事務**的結果。
