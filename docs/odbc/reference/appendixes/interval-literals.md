---
title: 間隔常值 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- data types [ODBC], interval data types
- interval literals [ODBC]
- interval data type [ODBC], literals
ms.assetid: f9e6c3c7-4f98-483f-89d8-ebc5680f021b
author: MightyPen
ms.author: genemi
ms.openlocfilehash: e90f7683c13d8693529c60f1ba893bd645920bb2
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/08/2020
ms.locfileid: "68041916"
---
# <a name="interval-literals"></a>間隔常值
ODBC 要求所有的驅動程式都必須支援將 SQL_CHAR 或 SQL_VARCHAR 資料類型轉換成所有 C interval 資料類型。 不過，如果基礎資料來源不支援間隔資料類型，則驅動程式必須知道 [SQL_CHAR] 欄位中值的正確格式，才能支援這些轉換。 同樣地，ODBC 會要求任何 ODBC C 類型可轉換為 SQL_CHAR 或 SQL_VARCHAR，因此驅動程式必須知道字元欄位中所儲存的間隔應該有何種格式。 本節描述間隔常值的語法，而驅動程式寫入器在轉換時，必須使用它們來驗證 SQL_CHAR 的欄位。  
  
> [!NOTE]  
>  間隔常值的完整 BNF 語法會顯示在附錄 C： SQL 文法中的[間隔常值語法](../../../odbc/reference/appendixes/interval-literal-syntax.md)一節中。  
  
 若要傳遞間隔常值做為 SQL 語句的一部分，則會針對間隔常值定義 escape 子句語法。 如需詳細資訊，請參閱[日期、時間和時間戳記常](../../../odbc/reference/develop-app/date-time-and-timestamp-literals.md)值。  
  
 間隔常值的格式如下：  
  
```  
INTERVAL[<sign>] 'value' <interval qualifier>  
```  
  
 其中，「間隔」表示字元常值是間隔。 正負號可以是加號或減號;它是在間隔字串之外，而且是選擇性的。  
  
 間隔限定詞可以是單一日期時間欄位，或由兩個日期時間欄位組成，格式為： \<*前置欄位*> 到\<*尾端欄位*>。  
  
-   當間隔是由單一欄位所組成時，單一欄位可以是非第二個欄位，而且可能會在括弧中加上選擇性的前置精確度。 [單一 datetime] 欄位也可以是第二個欄位，可能伴隨選擇性的前置精確度、選擇性的小數秒有效位數（以括弧括住），或兩者都有。 如果兩個秒欄位的前置精確度和小數秒有效位數都存在，則會以逗號分隔。 如果 [秒] 欄位具有小數秒有效位數，則也必須有前置精確度。  
  
-   當間隔是由前置和尾端欄位所組成時，前置欄位是一個非第二個欄位，可能會伴隨以括弧括住的欄位精確度間隔。 尾端欄位可以是非第二個欄位或第二個欄位，可能會伴隨以括弧括住的間隔小數秒有效位數。  
  
 [*值*] 中的間隔字串會以單引號括住。 它可以是年-月常值或日期時間常值。 [*值*] 中的字串格式取決於下列規則：  
  
-   字串包含\<*間隔**限定詞*> 所隱含之每個欄位的十進位值。  
  
-   如果間隔精確度包含 YEAR 和 MONTH 欄位，這些欄位的值會以負號分隔。  
  
-   如果間隔精確度包含 [日] 和 [小時] 欄位，則這些欄位的值會以空格分隔。  
  
-   如果間隔精確度包含「小時」和「較低順序」欄位（分和秒），這些欄位的值會以冒號分隔。  
  
-   如果間隔精確度包含第二個欄位，而表示或隱含的秒數有效位數為非零值，則在第二個小數部分的第一個數位前面的字元就是一個句號。  
  
-   欄位長度不能超過兩位數，但除外：  
  
    -   前置欄位的值可以是所表示或隱含間隔的有效位數。  
  
    -   第二個欄位的小數部分可以是已表示或隱含的秒數有效位數。  
  
    -   尾端欄位會遵循西曆的一般條件約束。 （請參閱[西曆的條件約束](../../../odbc/reference/appendixes/constraints-of-the-gregorian-calendar.md)）。  
  
 下表列出有效間隔常值的範例，其包含在 ODBC escape 子句中的間隔。 Escape 子句的語法如下所示：  
  
> [!NOTE]  
>  *{間隔簽署間隔-字串間隔-限定詞}*  
  
|常值轉義子句|指定的間隔|  
|---------------------------|------------------------|  
|{INTERVAL ' 326 ' 年（4）}|指定326年的間隔。 間隔前置精確度為4。|  
|{INTERVAL ' 326 ' 個月（3）}|指定326個月的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 3261 ' 天（4）}|指定3261天的間隔。 間隔前置精確度為4。|  
|{INTERVAL ' 163 ' 小時（3）}|指定163天的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 163 ' 分鐘（3）}|指定163分鐘的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 223.16 ' 秒（3，2）}|指定223.16 秒的間隔。 間隔的有效位數為3，而秒數有效位數為2。|  
|{INTERVAL ' 163-11 ' YEAR （3）至 MONTH}|指定163年和11個月的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 163 12 ' 天（3）至小時}|指定163天和12小時的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 163 12:39 ' 天（3）到分鐘}|指定163天、12小時和39分鐘的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 163 12：39： 59.163 ' DAY （3） TO SECOND （3）}|指定163天、12小時、39分鐘和59.163 秒的間隔。 間隔前置精確度為3，而秒數有效位數為3。|  
|{INTERVAL ' 163:39 ' 小時（3）到分鐘}|指定163小時和39分鐘的間隔。 間隔前置精確度為3。|  
|{INTERVAL ' 163：39： 59.163 ' 小時（3）到秒（4）}|指定163小時、39分鐘和59.163 秒的間隔。 間隔的有效位數為3，而秒數有效位數為4。|  
|{INTERVAL ' 163： 59.163 ' MINUTE （3）到 SECOND （5）}|指定163分鐘和59.163 秒的間隔。 間隔的有效位數為3，而秒數有效位數為5。|  
|{INTERVAL-' 16 23：39： 56.23 ' DAY TO SECOND}|指定減去16天、23小時、39分鐘和56.23 秒的間隔。 隱含的前導精確度為2，而隱含的秒數有效位數為6。|  
  
 下表列出無效間隔常值的範例：  
  
|常值轉義子句|不正確原因|  
|---------------------------|------------------------|  
|{INTERVAL ' 163 ' 小時（2）}|間隔前置精確度為2，但前置欄位的值為163。|  
|{INTERVAL ' 223.16 ' 秒（2，2）}<br /><br /> {INTERVAL ' 223.16 ' 秒（3，1）}|在第一個範例中，前置精確度太小，而在第二個範例中，秒數精確度太小。|  
|{INTERVAL ' 223.16 ' SECOND}<br /><br /> {INTERVAL ' 223 ' YEAR}|由於未指定前置精確度，因此會預設為2，這太小而無法保存指定的常值。|  
|{INTERVAL ' 22.1234567 ' SECOND}|秒數有效位數未指定，因此預設為6。 常值在小數點後面有七位數。|  
|{INTERVAL ' 163-13 ' YEAR （3）至 MONTH}<br /><br /> {INTERVAL ' 163 65 ' 天（3）至小時}<br /><br /> {INTERVAL ' 163 62:39 ' 天（3）到分鐘}<br /><br /> {INTERVAL ' 163 12：125： 59.163 ' DAY （3） TO SECOND （3）}<br /><br /> {INTERVAL ' 163:144 ' 小時（3）到分鐘}<br /><br /> {INTERVAL ' 163：567： 234.163 ' 小時（3）到秒（4）}<br /><br /> {INTERVAL ' 163： 591.163 ' MINUTE （3）到 SECOND （5）}|尾端欄位不會遵循西曆的規則。|
