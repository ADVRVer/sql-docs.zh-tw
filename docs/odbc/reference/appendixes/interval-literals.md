---
title: 間隔文字 |微軟文件
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- data types [ODBC], interval data types
- interval literals [ODBC]
- interval data type [ODBC], literals
ms.assetid: f9e6c3c7-4f98-483f-89d8-ebc5680f021b
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c1761ac0acb57b3f375a7d19e9371384c000eca5
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304939"
---
# <a name="interval-literals"></a>間隔常值
ODBC 要求所有驅動程式都支援將SQL_CHAR或SQL_VARCHAR數據類型轉換為所有 C 間隔數據類型。 但是,如果基礎數據源不支援間隔數據類型,則驅動程式需要知道SQL_CHAR欄位中值的正確格式,以支援這些轉換。 同樣,ODBC 要求任何 ODBC C 類型都可轉換為SQL_CHAR或SQL_VARCHAR,因此驅動程式需要知道字元欄位中存儲的間隔應具有哪種格式。 本節介紹間隔文本的語法,驅動程式編寫器需要在轉換到 C 間隔數據類型或從 C 間隔數據類型轉換期間使用該語法來驗證SQL_CHAR欄位。  
  
> [!NOTE]  
>  間隔文字的完整 BNF 語法顯示在附錄 C 中的[「間隔文字語法](../../../odbc/reference/appendixes/interval-literal-syntax.md)」部分:SQL 語法中。  
  
 要將間隔文字作為 SQL 語句的一部分傳遞,為間隔文本定義轉義子句語法。 關於詳細資訊,請參閱[日期、時間與時間戳文字](../../../odbc/reference/develop-app/date-time-and-timestamp-literals.md)。  
  
 間隔文字為表單:  
  
```  
INTERVAL[<sign>] 'value' <interval qualifier>  
```  
  
 其中"INTERVAL"表示字元文本是間隔。 符號可以是正負;它在間隔字串之外,是可選的。  
  
 間隔限定符可以是單個日期時間欄位,也可以由兩個日期時間欄位組成,形式為:\<*前導字段* \<> to*跟蹤欄位*>。  
  
-   當間隔由單個字段組成時,單個字段可以是一個非秒欄位,並可伴有括弧中的可選前導精度。 單日期時間欄位也可以是第二個字段,可以附帶可選的前導精度、括弧中的可選小數秒精度,或兩者。 如果前導精度和分數秒精度都存在秒欄位,則它們由逗號分隔。 如果秒字段具有分數秒精度,則還必須具有前導精度。  
  
-   當間隔由前導和尾隨欄位組成時,前導欄位是一個非秒欄位,可能伴隨著括弧中的間隔前導場精度。 尾隨欄位可以是非秒欄位,也可以是第二個字段,在括弧中可能伴隨著間隔分數秒精度。  
  
 *值*中的間隔字串以單個引弧括起來。 它可以是一年月字面或白天的字面。 *值*字串的格式由以下規則確定:  
  
-   字串包含\<*間隔**限定符*>隐含的每个字段的小数值。  
  
-   如果間隔精度包括欄位 YEAR 和 MONTH,則這些欄位的值用減號分隔。  
  
-   如果間隔精度包括欄位 DAY 和 HOUR,則這些欄位的值由空格分隔。  
  
-   如果間隔精度包括欄位 HOUR 和較低階欄位(分鐘欄位和秒),則這些欄位的值由冒號分隔。  
  
-   如果間隔精度包含一個"秒"欄位,並且表示或隱含的秒精度是非零,則緊鄰第二個小數部分第一個數位之前的字元是句點。  
  
-   除以下情況外,任何欄位都不可能超過兩位數位長:  
  
    -   前導欄位的值可以是表示或隱含的間隔前導精度。  
  
    -   第二個字段的小數部分可以長達表示或隱含的秒精度。  
  
    -   尾隨字段遵循公曆的通常約束。 ( 請參考[公曆的約束](../../../odbc/reference/appendixes/constraints-of-the-gregorian-calendar.md)。  
  
 下表列出了帶間隔的 ODBC 轉義子句中包含的有效間隔文本範例。 轉義子句的語法如下:  
  
> [!NOTE]  
>  *[INTERVAL 符號間隔-字串間隔限定)*  
  
|文字轉義子句|指定間隔|  
|---------------------------|------------------------|  
|[間隔 '326' 年份 (4)]|指定 326 年的間隔。 間隔前導精度為 4。|  
|間隔 '326' 月 (3)]|指定 326 個月的間隔。 間隔前導精度為 3。|  
|間隔 '3261' 天 (4)]|指定 3261 天的間隔。 間隔前導精度為 4。|  
|[間隔 '163' 小時 (3)]|指定 163 天的間隔。 間隔前導精度為 3。|  
|[間隔 '163' 分鐘 (3)]|指定 163 分鐘的間隔。 間隔前導精度為 3。|  
|[間隔 '223.16' 秒 (3,2)]|指定 223.16 秒的間隔。 間隔前導精度為 3,秒精度為 2。|  
|[間隔 '163-11' 年份 (3) 到月]|指定 163 年和 11 個月的間隔。 間隔前導精度為 3。|  
|[間隔 '163 12' 天 (3) 到小時*|指定 163 天和 12 小時的間隔。 間隔前導精度為 3。|  
|[間隔 '163 12:39' 天 (3) 到分鐘*|指定 163 天、12 小時和 39 分鐘的間隔。 間隔前導精度為 3。|  
|間隔 '163 12:39:59.163" 天 (3) 到秒 (3)]|指定 163 天、12 小時、39 分鐘和 59.163 秒的間隔。 間隔前導精度為 3,秒精度為 3。|  
|[間隔 '163:39' 小時 (3) 到分鐘*|指定 163 小時 39 分鐘的間隔。 間隔前導精度為 3。|  
|間隔 '163:39:59.163' 小時 (3) 到秒 (4)]|指定 163 小時、39 分鐘和 59.163 秒的間隔。 間隔前導精度為 3,秒精度為 4。|  
|[間隔 '163:59.163' 分鐘 (3) 到秒 (5)]|指定 163 分鐘和 59.163 秒的間隔。 間隔前導精度為 3,秒精度為 5。|  
|[間隔 - '16 23:39:56.23' 一天到第二*|指定零下 16 天、23 小時、39 分鐘和 56.23 秒的間隔。 隱含前導精度為 2,隱含秒精度為 6。|  
  
 下表列出了不合法間隔文字的範例:  
  
|文字轉義子句|不合法的|  
|---------------------------|------------------------|  
|[間隔 '163' 小時 (2)]|間隔前導精度為 2,但前導欄位的值為 163。|  
|[間隔 '223.16' 秒 (2,2)]<br /><br /> [間隔 '223.16' 秒 (3,1)]|在第一個示例中,前導精度太小,在第二個示例中,秒精度太小。|  
|[間隔 '223.16' 秒]<br /><br /> [間隔 '223' 年份]|由於未指定前導精度,因此預設為 2,該精度太小,無法容納指定的文本。|  
|[間隔 '22.1234567' 秒]|秒精度未指定,因此預設為6。 文本在小數點後有七位數位。|  
|[間隔 '163-13' 年份 (3) 到月]<br /><br /> [間隔 '163 65' 天 (3) 到小時*<br /><br /> [間隔 '163 62:39' 天 (3) 到分鐘*<br /><br /> 間隔 '163 12:125:59.163" 天 (3) 到秒 (3)]<br /><br /> [間隔 '163:144' 小時 (3) 到分鐘*<br /><br /> 間隔 '163:567:234.163' 小時 (3) 到秒 (4)]<br /><br /> 間隔 '163:591.163' 分鐘 (3) 到秒 (5)]|尾隨字段不遵循公曆的規則。|
