---
title: 什麼是資料指標？ | Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 0d5704a43e1ede850a225c4ec2b4df9a3563606b
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "63184876"
---
# <a name="what-is-a-cursor"></a>什麼是資料指標？
關聯式資料庫中的作業會針對完整的資料列集運作。 由 SELECT 陳述式所傳回的資料列集包括所有滿足陳述式 WHERE 子句之條件的資料列。 由陳述式傳回的完整資料列稱為結果集。 應用程式，尤其是互動式並上線，不一定有效能夠運用整個結果集視為一個單位。 這些應用程式需要一個機制，一次運用一個資料列或小型資料列區塊。 資料指標就是一種結果集的擴充，提供此種機制。  
  
 資料指標是由資料指標程式庫實作。 資料指標程式庫是軟體，通常會實作成一部分的資料庫系統或資料存取 API，用來管理資料從資料來源 （結果集） 所傳回的屬性。 這些屬性包括並行存取管理、 放置結果集中傳回的資料列數目，以及是否可以向前或向後移動 （或兩者） 查看結果集 （以可捲動性）。  
  
 資料指標會追蹤結果集中的位置，並可讓您執行多個作業列針對結果集，不論返回原始的資料表。 換句話說，資料指標在概念上傳回結果集，在資料庫內的資料表為基礎。 資料指標是如此命名是因為它會指出目前的位置，在結果集中，就像在電腦螢幕上的游標會指出目前的位置。  
  
 請務必熟悉資料指標的概念，再繼續進行了解在 ADO 中其使用方式的細節。  
  
 您可以使用資料指標：  
  
-   指定定位於結果集內的特定資料列。  
  
-   擷取一個資料列或目前的結果集位置為基礎的資料列的區塊。  
  
-   修改結果集目前位置的資料列中的資料。  
  
-   定義不同層級的敏感度，其他使用者所進行的資料變更。  
  
 例如，請考慮以潛在購買者顯示的可用產品清單的應用程式。 買方捲動清單，查看產品詳細資料和成本，以及最後選取 購買的產品。 其他的捲動和選取，就會發生清單的其餘部分。 只要購買者來說，產品會出現一次，但應用程式會使用可捲動資料指標向上和向下瀏覽的結果集。  
  
 您可以使用各種不同的方式中的資料指標：  
  
-   與完全沒有資料列。  
  
-   進行部分或全部的單一資料表中的資料列。  
  
-   進行部分或全部邏輯上聯結資料表的資料列。  
  
-   為唯讀或可更新資料指標或欄位層級。  
  
-   為順向或完整捲動。  
  
-   使用資料指標索引鍵集位於伺服器上。  
  
-   其他應用程式 （例如成員資格、 排序、 插入、 更新和刪除） 所造成的基礎資料表變更影響。  
  
-   現有的伺服器或用戶端上。  
  
 唯讀資料指標，幫助使用者瀏覽的結果集，以及讀取/寫入資料指標可以實作個別的資料列更新。 可以使用重新指向基底資料表的資料列的索引鍵集，定義複雜的資料指標。 雖然某些資料指標是唯讀的順向的方向，但其他人可以來回移動，並提供動態的重新整理，根據其他應用程式會對資料庫進行的變更結果集。  
  
 並非所有應用程式需要使用資料指標來存取或更新資料。 只需一些查詢不需要直接存取的資料列更新使用資料指標。 資料指標應該是您選擇 擷取資料的最後一個技巧的其中一個-然後您應該選擇最低的影響資料指標可能。 當您建立結果集所使用的預存程序時，結果集並非可使用資料指標更新編輯或更新方法。  
  
## <a name="concurrency"></a>並行  
 在某些多使用者的應用程式是非常重要的資料呈現給終端使用者必須一樣新。 這類系統的典型的例子為航空預訂系統，其中許多使用者可能會爭用相同的座位上指定的航班，因此，單一記錄）。 在這類情況下，應用程式的設計必須處理並行作業的單一記錄。  
  
 在 其他應用程式中，並行不重要。 在此情況下，無法對齊參與目前的資料隨時的保留費用。  
  
## <a name="position"></a>位置  
 資料指標也會追蹤的結果集內的目前位置。 將資料指標位置為目前的記錄，其方式類似於指標的陣列索引點，該陣列中的特定位置的值。  
  
## <a name="scrollability"></a>可捲動性  
 您的應用程式所採用的資料指標的類型也會影響結果集; 中的資料列移動向前及向後的功能這有時也稱為捲動。 向前移動的能力*和*回溯透過結果集將加入的資料指標，複雜度，因此實作成本更高。 基於這個理由，就應該使用這項功能只在必要時要求資料指標。
