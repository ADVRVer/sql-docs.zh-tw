---
title: 資料成形總覽 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], overview
ms.assetid: 4cb5fd29-4e56-46ac-ae48-a6771c321c0c
author: rothja
ms.author: jroth
ms.openlocfilehash: a6258c44d267462cea097c5553c9814b10d3787f
ms.sourcegitcommit: 6037fb1f1a5ddd933017029eda5f5c281939100c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2020
ms.locfileid: "82750282"
---
# <a name="data-shaping-overview"></a>資料成形概觀
*資料成形*表示在查詢中建立兩個或多個邏輯實體之間的階層式關聯性。 階層可以在一個[記錄集](../../../ado/reference/ado-api/recordset-object-ado.md)的記錄與另一個記錄**集**的一或多筆記錄（也稱為「章節」）之間的父子關聯性中看到。 在父子式關聯性中，父**記錄集**包含子**記錄集**。 這類階層式關聯性的範例為客戶和訂單。 針對資料庫中的每個客戶，可能會有零個或多個訂單。 階層式關聯性可以是遞迴的，這表示孫記錄可以嵌套在子記錄中。 就原則而言，階層式記錄可以嵌套到任何深度。 在實務上，ADO 會將遞迴限制為最多512個**記錄集**。  
  
 一般而言，塑造式**記錄集**的資料行可以包含資料提供者的資料，例如 Microsoft® SQL Server、另一個**記錄集**的參考、從**記錄集**的單一資料列上計算衍生的值，或從整個**記錄集**之資料行上的作業衍生的值。 資料行也可以是新製造和空白的。  
  
 當您抓取包含另一個**記錄集**參考的資料行值時，ADO 會自動傳回參考所表示的實際**記錄集**。 **記錄集**的參考實際上是子系子集的參考，稱為「章節」（*第二章*）。 單一父系可以參考一個以上的子**記錄集**。  
  
 資料成形的 ADO 支援可讓您查詢資料來源，並傳回一個記錄**集**，其中（父系）記錄代表（子系）記錄**集**。 在客戶訂單案例中，您可以使用資料成形來取出客戶的資訊，以及每個客戶在單一查詢中所放置的訂單。 結果**記錄集**也稱為成形**記錄集**。  
  
 此外，ADO 中的資料成形可讓您建立新的**記錄集**物件，而不需要基礎資料來源，方法是使用**new**關鍵字來描述父系和子**記錄集**的欄位。 然後，新的**記錄集**物件可以填入資料並持續儲存。 開發人員也可以在子欄位上執行各種計算或**匯總**（例如 SUM、 **AVG**和**MAX**）。 資料成形也可以藉由將子系中的記錄分組，然後在子系中的每個群組的父系中放置一個資料列，從子**記錄集**建立父**記錄集**。  
  
 一般 SQL 可讓您使用**聯結**語法來抓取資料，但這可能會沒有效率且不會變得很困難，因為在針對指定的父子式關聯性傳回的每一筆記錄中，重複的父資料。 資料成形可以讓父記錄**集中**的單一父記錄與子**記錄集中**的多個子記錄產生關聯，以避免**聯結**的重複。 大部分的人都發現父子式多個**記錄集**程式設計模型比單一**記錄集聯結**模型更自然且更容易使用。
