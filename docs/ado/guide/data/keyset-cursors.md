---
description: 索引鍵集資料指標
title: 索引鍵集資料指標 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c84bf798dcdb543dd0ae407474aa68cfb06a9ba
ms.sourcegitcommit: 18a98ea6a30d448aa6195e10ea2413be7e837e94
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/27/2020
ms.locfileid: "88980339"
---
# <a name="keyset-cursors"></a>索引鍵集資料指標
索引鍵集資料指標可在靜態和動態資料指標之間，提供偵測變更的功能。 如同靜態資料指標，它不一定會偵測結果集的成員資格和順序變更。 如同動態資料指標，它會偵測結果集中的資料列值變更。  
  
 索引鍵集驅動資料指標是由稱為索引鍵集的一組唯一識別碼 (索引鍵) 所控制。 索引鍵是從結果集中唯一識別資料列的一組資料行建立的。 索引鍵集是一組取自由查詢陳述式傳回之所有資料列的索引鍵值。  
  
 使用索引鍵集驅動資料指標，會在資料指標中為每個資料列建置和保留一個索引鍵，並儲存在用戶端工作站或伺服器上。 當您存取每個資料列時，會使用此預存金鑰從資料來源擷取目前的資料值。 在索引鍵集驅動資料指標中，當完整擴展索引鍵集時，結果集的成員資格會遭到凍結。 之後，在重新開啟之前，都不會在結果集中新增或更新受影響的成員資格。  
  
 索引鍵集擁有者或其他) 進程 (所做的資料值變更，會在使用者滾動結果集時看見。 只有在關閉並重新開啟資料指標之後，才能看見其他處理序在資料指標外部執行的插入。 在結果集結尾可看見從資料指標內部執行的插入。  
  
 當索引鍵集驅動的資料指標嘗試抓取已刪除的資料列時，資料列會在結果集中顯示為「洞」。 索引鍵集中存在資料列的索引鍵，但結果集中不再有此資料列。 如果資料列中的索引鍵值已更新，資料列就會被視為已刪除然後插入，因此這類資料列也會顯示為結果集中的漏洞。 當索引鍵集驅動的資料指標一律可以偵測其他進程刪除的資料列時，它可以選擇性地移除本身所刪除之資料列的索引鍵。 這樣做的索引鍵集驅動資料指標無法偵測自己的刪除，因為已移除辨識項。  
  
 索引鍵資料行的更新，就像是刪除舊的金鑰，然後插入新的索引鍵一樣。 如果未透過資料指標進行更新，就看不到新的索引鍵值。 如果透過資料指標進行更新，就會在結果集的結尾看見新的索引鍵值。  
  
 索引鍵集驅動的資料指標有一種變化，稱為索引鍵集驅動的標準資料指標。 在索引鍵集驅動的標準資料指標中，結果集的資料列成員資格和資料列的順序會在資料指標開啟時固定，但是資料指標擁有者所做的值變更，以及其他進程所做的認可變更都可以看見。 如果變更 disqualifies 成員資格的資料列，或影響資料列的順序，除非資料指標已關閉並重新開啟，否則資料列不會消失或移動。 插入的資料不會出現，但現有資料的變更會在提取資料列時出現。  
  
 索引鍵集驅動的資料指標很難正確使用，因為資料變更的敏感度取決於許多不同的情況，如上面所述。 但是，如果您的應用程式不在意並行更新，可以透過程式設計方式處理錯誤的索引鍵，而且必須直接存取某些索引資料列，索引鍵集驅動的資料指標可能會很適合您。 使用 **AdOpenKeyset CursorTypeEnum** 來指出您想要在 ADO 中使用索引鍵集資料指標。  
  
## <a name="see-also"></a>另請參閱  
 [順向資料指標](./forward-only-cursors.md)   
 [靜態資料指標](./static-cursors.md)   
 [動態資料指標](./dynamic-cursors.md)